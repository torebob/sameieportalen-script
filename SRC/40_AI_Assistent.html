<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="utf-8">
    <title>AI Assistent</title>
    <base target="_top">
    <style>
      :root{--bg:#0b1220;--card:#0f172a;--muted:#94a3b8;--border:#1f2937;--primary:#3b82f6;--success:#10b981;--warning:#f59e0b;--danger:#ef4444}
      *{box-sizing:border-box}
      body{margin:0;padding:12px;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,system-ui,sans-serif;background:var(--bg);color:#fff;line-height:1.5}
      main {max-width: 800px; margin: 20px auto; display: flex; flex-direction: column; gap: 20px;}
      .chat-container { display: flex; flex-direction: column; height: 70vh; background-color: var(--card); border-radius: 8px; border: 1px solid var(--border); }
      .chat-messages { flex-grow: 1; padding: 20px; overflow-y: auto; }
      .message { margin-bottom: 15px; }
      .message.user { text-align: right; }
      .message-bubble { display: inline-block; padding: 10px 15px; border-radius: 20px; max-width: 80%; }
      .user .message-bubble { background-color: var(--primary); color: white; }
      .bot .message-bubble { background-color: #2c3e50; color: white; }
      .chat-input { display: flex; padding: 20px; border-top: 1px solid var(--border); }
      #message-input { flex-grow: 1; background-color: #2c3e50; border: 1px solid var(--border); border-radius: 20px; padding: 10px 15px; color: white; font-size: 16px; }
      #send-btn { background-color: var(--primary); color: white; border: none; border-radius: 20px; padding: 10px 20px; margin-left: 10px; cursor: pointer; }
      #send-btn:disabled { background-color: #555; cursor: not-allowed; }
    </style>
</head>
<body>
    <main>
        <div class="chat-container">
            <div class="chat-messages" id="chat-messages">
                <div class="message bot">
                    <div class="message-bubble">Hei! Spør meg om hva som helst relatert til sameiets dokumenter og regelverk.</div>
                </div>
            </div>
            <div class="chat-input">
                <input type="text" id="message-input" placeholder="Skriv inn ditt spørsmål...">
                <button id="send-btn">Send</button>
            </div>
        </div>
    </main>
    <script>
      const chatMessages = document.getElementById('chat-messages');
      const messageInput = document.getElementById('message-input');
      const sendBtn = document.getElementById('send-btn');

      function addMessage(sender, text) {
        const messageElement = document.createElement('div');
        messageElement.classList.add('message', sender);
        const bubble = document.createElement('div');
        bubble.classList.add('message-bubble');
        bubble.textContent = text;
        messageElement.appendChild(bubble);
        chatMessages.appendChild(messageElement);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function handleSend() {
        const question = messageInput.value.trim();
        if (!question) return;

        addMessage('user', question);
        messageInput.value = '';
        sendBtn.disabled = true;

        google.script.run
            .withSuccessHandler(answer => {
                addMessage('bot', answer);
                sendBtn.disabled = false;
            })
            .withFailureHandler(error => {
                addMessage('bot', 'Beklager, en feil oppstod: ' + error.message);
                sendBtn.disabled = false;
            })
            .getAiFaqAnswer(question);
      }

      sendBtn.addEventListener('click', handleSend);
      messageInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          handleSend();
        }
      });
    </script>
</body>
</html>